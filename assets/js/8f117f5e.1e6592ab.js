"use strict";(globalThis.webpackChunkyarnl_docs=globalThis.webpackChunkyarnl_docs||[]).push([[4506],{1162(e,s,n){n.r(s),n.d(s,{assets:()=>c,contentTitle:()=>d,default:()=>h,frontMatter:()=>l,metadata:()=>i,toc:()=>a});const i=JSON.parse('{"id":"guide/users-and-authentication","title":"Users & Authentication","description":"Multi-user support with role-based access and SSO","source":"@site/docs/guide/users-and-authentication.md","sourceDirName":"guide","slug":"/guide/users-and-authentication","permalink":"/docs/guide/users-and-authentication","draft":false,"unlisted":false,"editUrl":"https://github.com/titandrive/yarnl-docs/tree/main/docs/guide/users-and-authentication.md","tags":[],"version":"current","sidebarPosition":9,"frontMatter":{"sidebar_position":9,"title":"Users & Authentication","description":"Multi-user support with role-based access and SSO"},"sidebar":"tutorialSidebar","previous":{"title":"Markdown","permalink":"/docs/guide/markdown"},"next":{"title":"Settings","permalink":"/docs/category/settings"}}');var r=n(4848),t=n(8453);const l={sidebar_position:9,title:"Users & Authentication",description:"Multi-user support with role-based access and SSO"},d="Users & Authentication",c={},a=[{value:"User Roles",id:"user-roles",level:2},{value:"Authentication Methods",id:"authentication-methods",level:2},{value:"Local Authentication",id:"local-authentication",level:3},{value:"OIDC/SSO",id:"oidcsso",level:3},{value:"Passwords",id:"passwords",level:2},{value:"Initial Setup",id:"initial-setup",level:3},{value:"Single-User Mode",id:"single-user-mode",level:3},{value:"Multi-User Mode",id:"multi-user-mode",level:3},{value:"Managing Passwords",id:"managing-passwords",level:3},{value:"User Management",id:"user-management",level:2},{value:"User Badges",id:"user-badges",level:3},{value:"Setting Up OIDC/SSO",id:"setting-up-oidcsso",level:2},{value:"Options",id:"options",level:3},{value:"Data Isolation",id:"data-isolation",level:2},{value:"Account Settings",id:"account-settings",level:2},{value:"Admin Backup &amp; Restore",id:"admin-backup--restore",level:2},{value:"Configuration (JSON)",id:"configuration-json",level:3},{value:"User Data (ZIP)",id:"user-data-zip",level:3},{value:"Environment Variables",id:"environment-variables",level:2},{value:"Security",id:"security",level:2}];function o(e){const s={admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,t.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(s.header,{children:(0,r.jsx)(s.h1,{id:"users--authentication",children:"Users & Authentication"})}),"\n",(0,r.jsx)(s.p,{children:"Yarnl supports multiple users with role-based access control and flexible authentication options."}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsx)(s.h2,{id:"user-roles",children:"User Roles"}),"\n",(0,r.jsxs)(s.table,{children:[(0,r.jsx)(s.thead,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.th,{children:"Role"}),(0,r.jsx)(s.th,{children:"Access"})]})}),(0,r.jsxs)(s.tbody,{children:[(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"Admin"})}),(0,r.jsx)(s.td,{children:"Full access, user management, OIDC config, system backups"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"User"})}),(0,r.jsx)(s.td,{children:"Personal pattern library only, isolated data"})]})]})]}),"\n",(0,r.jsx)(s.p,{children:"Admins can manage other users, configure SSO, and access system-wide backup/restore. Regular users have their own private pattern library."}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsx)(s.h2,{id:"authentication-methods",children:"Authentication Methods"}),"\n",(0,r.jsxs)("div",{className:"steps-grid",children:[(0,r.jsxs)("div",{className:"step-box",children:[(0,r.jsx)(s.h3,{id:"local-authentication",children:"Local Authentication"}),(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:"Username + password (bcrypt hashed)"}),"\n",(0,r.jsx)(s.li,{children:"Default admin via environment variables"}),"\n",(0,r.jsx)(s.li,{children:"Users can change their own passwords"}),"\n"]})]}),(0,r.jsxs)("div",{className:"step-box",children:[(0,r.jsx)(s.h3,{id:"oidcsso",children:"OIDC/SSO"}),(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:"Any OpenID Connect provider"}),"\n",(0,r.jsx)(s.li,{children:"PocketID, Authentik, Keycloak, etc."}),"\n",(0,r.jsx)(s.li,{children:"Auto-discovery via issuer URL"}),"\n"]})]})]}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsx)(s.h2,{id:"passwords",children:"Passwords"}),"\n",(0,r.jsx)(s.p,{children:"Passwords in Yarnl are always optional. This allows for flexible authentication depending on your setup."}),"\n",(0,r.jsx)(s.h3,{id:"initial-setup",children:"Initial Setup"}),"\n",(0,r.jsx)(s.p,{children:"When Yarnl first starts, it creates an admin account using environment variables:"}),"\n",(0,r.jsxs)(s.table,{children:[(0,r.jsx)(s.thead,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.th,{children:"Variable"}),(0,r.jsx)(s.th,{children:"Required"}),(0,r.jsx)(s.th,{children:"Default"})]})}),(0,r.jsxs)(s.tbody,{children:[(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"ADMIN_USERNAME"})}),(0,r.jsx)(s.td,{children:"Yes"}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"admin"})})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"ADMIN_PASSWORD"})}),(0,r.jsx)(s.td,{children:"No"}),(0,r.jsx)(s.td,{children:"(none)"})]})]})]}),"\n",(0,r.jsxs)(s.p,{children:["If ",(0,r.jsx)(s.code,{children:"ADMIN_PASSWORD"})," is not set, the admin account is created without a password."]}),"\n",(0,r.jsx)(s.h3,{id:"single-user-mode",children:"Single-User Mode"}),"\n",(0,r.jsx)(s.p,{children:"If there's only one user (the admin) and that user has no password, Yarnl skips the login screen entirely and loads directly into the home page. This is ideal for personal, single-user deployments."}),"\n",(0,r.jsx)(s.h3,{id:"multi-user-mode",children:"Multi-User Mode"}),"\n",(0,r.jsx)(s.p,{children:"When multiple users exist, Yarnl always shows the login screen. Users without passwords can log in by just entering their username."}),"\n",(0,r.jsx)(s.h3,{id:"managing-passwords",children:"Managing Passwords"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:"Passwords can be set or removed at any time"}),"\n",(0,r.jsxs)(s.li,{children:["Users manage their own password in ",(0,r.jsx)(s.strong,{children:"Settings \u2192 Account"})]}),"\n",(0,r.jsxs)(s.li,{children:["Admins can set or remove passwords for any user in ",(0,r.jsx)(s.strong,{children:"Settings \u2192 Users"})]}),"\n"]}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsx)(s.h2,{id:"user-management",children:"User Management"}),"\n",(0,r.jsxs)(s.p,{children:["Admins manage users from ",(0,r.jsx)(s.strong,{children:"Settings"})," \u2192 ",(0,r.jsx)(s.strong,{children:"Users"}),":"]}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Add User"})," \u2014 Create local accounts"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Delete User"})," \u2014 Remove accounts (can't delete yourself)"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Change Role"})," \u2014 Toggle admin/user"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Set Password"})," \u2014 Set or reset passwords"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Remove Password"})," \u2014 Clear password (user logs in with username only)"]}),"\n"]}),"\n",(0,r.jsx)(s.h3,{id:"user-badges",children:"User Badges"}),"\n",(0,r.jsxs)(s.table,{children:[(0,r.jsx)(s.thead,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.th,{children:"Badge"}),(0,r.jsx)(s.th,{children:"Color"}),(0,r.jsx)(s.th,{children:"Meaning"})]})}),(0,r.jsxs)(s.tbody,{children:[(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"ADMIN / USER"}),(0,r.jsx)(s.td,{children:"Purple"}),(0,r.jsx)(s.td,{children:"User's role"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"LOCAL / [Provider]"}),(0,r.jsx)(s.td,{children:"Cyan"}),(0,r.jsx)(s.td,{children:"Auth method"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"PW"}),(0,r.jsx)(s.td,{children:"Green"}),(0,r.jsx)(s.td,{children:"Has local password"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"YOU"}),(0,r.jsx)(s.td,{children:"Amber"}),(0,r.jsx)(s.td,{children:"Current user"})]})]})]}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsx)(s.h2,{id:"setting-up-oidcsso",children:"Setting Up OIDC/SSO"}),"\n",(0,r.jsx)(s.p,{children:"Setting up SSO with Yarnl is simple\u2014no manual endpoint configuration required."}),"\n",(0,r.jsxs)(s.p,{children:["Go to ",(0,r.jsx)(s.strong,{children:"Settings"})," \u2192 ",(0,r.jsx)(s.strong,{children:"OIDC/SSO"})," (admin only):"]}),"\n",(0,r.jsxs)(s.ol,{children:["\n",(0,r.jsxs)(s.li,{children:["Enter your ",(0,r.jsx)(s.strong,{children:"Issuer URL"})," (e.g., ",(0,r.jsx)(s.code,{children:"https://auth.example.com"}),")"]}),"\n",(0,r.jsxs)(s.li,{children:["Click ",(0,r.jsx)(s.strong,{children:"Discover"})," \u2014 Yarnl auto-discovers and populates all OIDC endpoints"]}),"\n",(0,r.jsxs)(s.li,{children:["Enter ",(0,r.jsx)(s.strong,{children:"Client ID"})," and ",(0,r.jsx)(s.strong,{children:"Client Secret"})," from your provider"]}),"\n",(0,r.jsx)(s.li,{children:"Save"}),"\n"]}),"\n",(0,r.jsx)(s.p,{children:"That's it. Yarnl handles the rest automatically."}),"\n",(0,r.jsx)(s.h3,{id:"options",children:"Options"}),"\n",(0,r.jsxs)(s.table,{children:[(0,r.jsx)(s.thead,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.th,{children:"Option"}),(0,r.jsx)(s.th,{children:"Description"})]})}),(0,r.jsxs)(s.tbody,{children:[(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"Auto-create users"})}),(0,r.jsx)(s.td,{children:"Automatically create accounts for new SSO users"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"Default role"})}),(0,r.jsx)(s.td,{children:"Role assigned to new SSO users (admin or user)"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"Disable local login"})}),(0,r.jsx)(s.td,{children:"Force SSO-only authentication"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"Provider name"})}),(0,r.jsx)(s.td,{children:"Custom label for the SSO button"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"Icon URL"})}),(0,r.jsx)(s.td,{children:"Custom icon for the login button"})]})]})]}),"\n",(0,r.jsx)(s.admonition,{type:"tip",children:(0,r.jsx)(s.p,{children:"Users authenticated via OIDC display a badge showing their provider name."})}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsx)(s.h2,{id:"data-isolation",children:"Data Isolation"}),"\n",(0,r.jsx)(s.p,{children:"Each user's data is completely separate:"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{children:"users/\n\u251c\u2500\u2500 alice/\n\u2502   \u251c\u2500\u2500 patterns/\n\u2502   \u251c\u2500\u2500 archive/\n\u2502   \u2514\u2500\u2500 backups/\n\u2514\u2500\u2500 bob/\n    \u251c\u2500\u2500 patterns/\n    \u251c\u2500\u2500 archive/\n    \u2514\u2500\u2500 backups/\n"})}),"\n",(0,r.jsx)(s.p,{children:"All patterns, counters, notes, and settings are scoped to each user. API endpoints verify ownership before allowing access."}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsx)(s.h2,{id:"account-settings",children:"Account Settings"}),"\n",(0,r.jsxs)(s.p,{children:["Users manage their own account in ",(0,r.jsx)(s.strong,{children:"Settings"})," \u2192 ",(0,r.jsx)(s.strong,{children:"Account"}),":"]}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:"Change username"}),"\n",(0,r.jsx)(s.li,{children:"Change password"}),"\n",(0,r.jsx)(s.li,{children:"View account info (role, auth method)"}),"\n"]}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsx)(s.h2,{id:"admin-backup--restore",children:"Admin Backup & Restore"}),"\n",(0,r.jsxs)(s.p,{children:["Admins have access to system-wide backups in ",(0,r.jsx)(s.strong,{children:"Settings"})," \u2192 ",(0,r.jsx)(s.strong,{children:"Admin Backup & Restore"}),":"]}),"\n",(0,r.jsxs)("div",{className:"steps-grid",children:[(0,r.jsxs)("div",{className:"step-box",children:[(0,r.jsx)(s.h3,{id:"configuration-json",children:"Configuration (JSON)"}),(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:"All user accounts (no passwords)"}),"\n",(0,r.jsx)(s.li,{children:"OIDC/SSO settings"}),"\n",(0,r.jsx)(s.li,{children:"Default categories"}),"\n",(0,r.jsx)(s.li,{children:"Application settings"}),"\n"]})]}),(0,r.jsxs)("div",{className:"step-box",children:[(0,r.jsx)(s.h3,{id:"user-data-zip",children:"User Data (ZIP)"}),(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:"All pattern files for all users"}),"\n",(0,r.jsx)(s.li,{children:"All archived patterns"}),"\n",(0,r.jsx)(s.li,{children:"Complete file structure"}),"\n"]})]})]}),"\n",(0,r.jsx)(s.p,{children:"Use these to migrate or recover an entire Yarnl instance."}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsx)(s.h2,{id:"environment-variables",children:"Environment Variables"}),"\n",(0,r.jsxs)(s.table,{children:[(0,r.jsx)(s.thead,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.th,{children:"Variable"}),(0,r.jsx)(s.th,{children:"Description"}),(0,r.jsx)(s.th,{children:"Default"})]})}),(0,r.jsxs)(s.tbody,{children:[(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"ADMIN_USERNAME"})}),(0,r.jsx)(s.td,{children:"Admin username (required)"}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"admin"})})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"ADMIN_PASSWORD"})}),(0,r.jsx)(s.td,{children:"Admin password (optional)"}),(0,r.jsx)(s.td,{children:"(none)"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"FORCE_LOCAL_LOGIN"})}),(0,r.jsx)(s.td,{children:"Bypass OIDC, show local login"}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"false"})})]})]})]}),"\n",(0,r.jsx)(s.admonition,{title:"Emergency Access",type:"tip",children:(0,r.jsxs)(s.p,{children:["If OIDC is misconfigured and you're locked out, set ",(0,r.jsx)(s.code,{children:"FORCE_LOCAL_LOGIN=true"})," to bypass SSO and access local login."]})}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsx)(s.h2,{id:"security",children:"Security"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:"All API endpoints require authentication"}),"\n",(0,r.jsx)(s.li,{children:"Passwords hashed with bcrypt"}),"\n",(0,r.jsx)(s.li,{children:"Session-based auth with secure cookies"}),"\n",(0,r.jsx)(s.li,{children:"Ownership verified on all data access"}),"\n",(0,r.jsx)(s.li,{children:"OIDC tokens validated against provider"}),"\n"]})]})}function h(e={}){const{wrapper:s}={...(0,t.R)(),...e.components};return s?(0,r.jsx)(s,{...e,children:(0,r.jsx)(o,{...e})}):o(e)}},8453(e,s,n){n.d(s,{R:()=>l,x:()=>d});var i=n(6540);const r={},t=i.createContext(r);function l(e){const s=i.useContext(t);return i.useMemo(function(){return"function"==typeof e?e(s):{...s,...e}},[s,e])}function d(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:l(e.components),i.createElement(t.Provider,{value:s},e.children)}}}]);